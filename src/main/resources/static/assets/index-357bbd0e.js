import{R as a,S as j,U as l,V as w,W as t,X as v,c,Y as q,Z as F,_ as o,l as A,$ as y,F as P,L as O,s as N,v as U,r as W,B as G,M as H}from"./@vue-dab65bb8.js";import{R as T,c as K,a as X}from"./vue-router-eb0942b5.js";import{a as b}from"./axios-4a70c6fc.js";import{q as I}from"./qs-d4631b6c.js";import{u as R,n as Y}from"./naive-ui-8a1e150c.js";import"./@babel-13dfc480.js";import"./side-channel-811df36f.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-a6c0fd6b.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./@css-render-7c618a34.js";import"./seemly-800cfbee.js";import"./lodash-es-6e62c14c.js";import"./vooks-c9bafa7c.js";import"./evtd-b614532e.js";import"./vueuc-50a0eafc.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./date-fns-3ec8b6e2.js";import"./treemate-2e4f98ca.js";import"./date-fns-tz-5989762d.js";import"./async-validator-dee29e8b.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))p(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&p(m)}).observe(document,{childList:!0,subtree:!0});function i(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerPolicy&&(u.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?u.credentials="include":n.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function p(n){if(n.ep)return;n.ep=!0;const u=i(n);fetch(n.href,u)}})();const S=(s,e)=>{const i=s.__vccOpts||s;for(const[p,n]of e)i[p]=n;return i},Z={};function J(s,e){const i=a("router-view"),p=a("n-message-provider");return w(),j(p,null,{default:l(()=>[t(i)]),_:1})}const Q=S(Z,[["render",J]]),M="/naivelogo.svg";let ee="http://"+window.location.host;const te={name:"index",data(){return{no:"",password:""}},setup(){window.$message=R()},methods:{login(){let s=this;b.post(ee+"/api/login",I.stringify({no:this.no,password:this.password})).then(e=>{e.data.status===0?(window.$message.success("登录成功"),sessionStorage.setItem("name",e.data.data.split("/")[1]),e.data.data.split("/")[0]==="0"?s.$router.replace("/admin"):e.data.data.split("/")[0]==="1"?s.$router.replace("/teacher"):e.data.data.split("/")[0]==="2"&&s.$router.replace("/student")):window.$message.error("登录失败")}).catch(()=>{window.$message.error("未知异常")})}}},B=s=>(q("data-v-fc6e0aaa"),s=s(),F(),s),ne={style:{height:"100%","text-align":"center"}},oe=B(()=>o("img",{height:"80",src:M},null,-1)),se=B(()=>o("br",null,null,-1)),le=B(()=>o("br",null,null,-1)),ae=B(()=>o("br",null,null,-1)),re=B(()=>o("div",null,[c(" 学生默认学号4100**"),o("br"),c(" 教师默认工号200**"),o("br"),o("span",{class:"manager-acc"},"管理员账号为10086"),o("br"),c(" 默认密码为12345,请在登陆后修改密码."),o("br"),c(" 本信息栏仅作调试用 ")],-1));function ie(s,e,i,p,n,u){const m=a("n-input"),h=a("n-button"),g=a("n-card"),_=a("n-collapse-item"),f=a("n-collapse");return w(),v("div",ne,[t(g,{class:"logincard",title:"成绩管理"},{default:l(()=>[oe,se,c(" 统一认证"),le,t(m,{size:"large",round:"",value:n.no,"onUpdate:value":e[0]||(e[0]=x=>n.no=x),placeholder:"学号或工号"},null,8,["value"]),t(m,{size:"large",round:"",type:"password",value:n.password,"onUpdate:value":e[1]||(e[1]=x=>n.password=x),placeholder:"密码"},null,8,["value"]),t(h,{onClick:u.login,strong:"",secondary:"",round:"",type:"info"},{default:l(()=>[c("登录")]),_:1},8,["onClick"])]),_:1}),ae,t(g,null,{default:l(()=>[t(f,{"arrow-placement":"right"},{default:l(()=>[t(_,{title:"登录信息",name:"1"},{default:l(()=>[re]),_:1})]),_:1})]),_:1})])}const ue=S(te,[["render",ie],["__scopeId","data-v-fc6e0aaa"]]),ce={name:"admin_page",data(){return{}},methods:{logout(){sessionStorage.clear(),this.$router.replace("/index")}},setup(){console.log(sessionStorage.getItem("name"));let s=sessionStorage.getItem("name");return window.$message=R(),{menuOptions:[{label:()=>A(T,{to:"/admin/user"},()=>"用户管理"),key:"user"},{label:()=>A(T,{to:"/admin/course"},()=>"课程管理"),key:"course"},{label:()=>A(T,{to:"/admin/teach"},()=>"教学管理"),key:"teach"}],name:s}}},de=o("div",{class:"titlec"},[o("img",{class:"logoi",height:"36",src:M}),o("span",{class:"titlei"},"成绩管理-管理端")],-1),pe={class:"userinfo"};function _e(s,e,i,p,n,u){const m=a("n-button"),h=a("n-layout-header"),g=a("n-menu"),_=a("n-layout-sider"),f=a("router-view"),x=a("n-layout"),d=a("n-layout-footer");return w(),j(x,{position:"absolute"},{default:l(()=>[t(h,{style:{height:"64px",top:"0px"},bordered:""},{default:l(()=>[de,o("div",pe,[c(" 你好, "+y(p.name)+" ",1),t(m,{round:"",tertiary:"",type:"error",onClick:u.logout},{default:l(()=>[c("退出")]),_:1},8,["onClick"])])]),_:1}),t(x,{"has-sider":"",position:"absolute",style:{top:"64px",bottom:"64px"}},{default:l(()=>[t(_,{bordered:"","content-style":"padding: 4px;"},{default:l(()=>[t(g,{options:p.menuOptions},null,8,["options"])]),_:1}),t(x,{"content-style":"padding: 24px;"},{default:l(()=>[t(f)]),_:1})]),_:1}),t(d,{bordered:"",position:"absolute",style:{height:"64px",padding:"24px","text-align":"center"}},{default:l(()=>[c(" gradeManagement   成绩管理 ")]),_:1})]),_:1})}const me=S(ce,[["render",_e]]);let E="http://"+window.location.host;const he={name:"user_manage",methods:{deleteUser(s){let e=this;b.post(E+"/api/user/delete-user",I.stringify({no:s})).then(i=>{i.data.status===0&&(window.$message.success("删除完毕"),e.getByPage(e.page))})},addNewUser(){let s=this;this.role===""||this.username===""||this.userNo===""?window.$message.info("信息缺失"):b.post(E+"/api/user/add-new-user",I.stringify({no:this.userNo,name:this.username,role:this.role})).then(e=>{e.data.status===0?(window.$message.success("添加成功"),s.newUserDialog=!1,s.getByPage(s.page)):window.$message.error("添加失败, 号码不能相同")})},makeNewPassword(){let s=this;b.post(E+"/api/user/change-password",I.stringify({no:this.changingNo,newPass:this.newPassword})).then(e=>{s.changePasswordDialog=!1,window.$message.success("密码已更改")})},changePassword(s){this.changePasswordDialog=!0,this.changingNo=s},getByPage(s){let e=this;b.get(E+"/api/user/get-users-by-page?pageNum="+s).then(i=>{e.users=i.data.data.indices,e.pageNum=i.data.data.pageNum,e.users.forEach(p=>{switch(p.role){case 1:{p.role="教师";break}case 0:{p.role="管理员";break}case 2:{p.role="学生";break}}})})}},data(){return{users:[],changePasswordDialog:!1,changingNo:-1,newPassword:"",role:"",newUserDialog:!1,userNo:"",username:"",pageNum:0,page:1}},mounted(){this.getByPage(1)}},ge=o("p",{style:{"margin-top":"20px"}},"角色",-1),fe=o("br",null,null,-1),we=o("thead",null,[o("tr",null,[o("th",null,"UUID"),o("th",null,"姓名"),o("th",null,"角色"),o("th",null,"操作")])],-1),ye={key:"user"},ve={style:{"text-align":"center","margin-top":"20px"}},be={style:{display:"inline-block"}};function xe(s,e,i,p,n,u){const m=a("n-input"),h=a("n-button"),g=a("n-modal"),_=a("n-radio-button"),f=a("n-radio-group"),x=a("n-space"),d=a("n-table"),C=a("n-pagination");return w(),v(P,null,[t(g,{show:n.changePasswordDialog,"onUpdate:show":e[1]||(e[1]=r=>n.changePasswordDialog=r),title:"更改密码",preset:"dialog"},{default:l(()=>[t(m,{style:{"margin-top":"10px","margin-bottom":"10px"},value:n.newPassword,"onUpdate:value":e[0]||(e[0]=r=>n.newPassword=r),placeholder:"新密码"},null,8,["value"]),t(h,{onClick:u.makeNewPassword},{default:l(()=>[c("确定")]),_:1},8,["onClick"])]),_:1},8,["show"]),t(g,{style:{"text-align":"center"},show:n.newUserDialog,"onUpdate:show":e[5]||(e[5]=r=>n.newUserDialog=r),title:"新建用户",preset:"dialog"},{default:l(()=>[t(m,{round:"",large:"",style:{"margin-top":"10px","margin-bottom":"10px"},value:n.userNo,"onUpdate:value":e[2]||(e[2]=r=>n.userNo=r),placeholder:"学号或工号"},null,8,["value"]),t(m,{round:"",large:"",style:{"margin-top":"10px"},value:n.username,"onUpdate:value":e[3]||(e[3]=r=>n.username=r),placeholder:"姓名"},null,8,["value"]),ge,t(f,{value:n.role,"onUpdate:value":e[4]||(e[4]=r=>n.role=r),style:{"margin-bottom":"20px"}},{default:l(()=>[t(_,{key:"1",value:"1",label:"教师"}),t(_,{key:"0",value:"0",label:"管理员"}),t(_,{key:"2",value:"2",label:"学生"})]),_:1},8,["value"]),fe,t(h,{strong:"",secondary:"",round:"",type:"info",onClick:u.addNewUser},{default:l(()=>[c("确定")]),_:1},8,["onClick"])]),_:1},8,["show"]),t(x,{style:{"margin-bottom":"10px"}},{default:l(()=>[t(h,{strong:"",secondary:"",round:"",type:"info",onClick:e[6]||(e[6]=r=>n.newUserDialog=!0)},{default:l(()=>[c("新建用户")]),_:1})]),_:1}),t(d,null,{default:l(()=>[we,o("tbody",null,[(w(!0),v(P,null,O(n.users,r=>(w(),v("tr",ye,[o("td",null,y(r.no),1),o("td",null,y(r.name),1),o("td",null,y(r.role),1),o("td",null,[t(x,{vertical:!1},{default:l(()=>[t(h,{strong:"",secondary:"",round:"",type:"warning",onClick:D=>u.changePassword(r.no)},{default:l(()=>[c("更改密码")]),_:2},1032,["onClick"]),t(h,{strong:"",secondary:"",round:"",type:"error",onClick:D=>u.deleteUser(r.no)},{default:l(()=>[c("移除用户")]),_:2},1032,["onClick"])]),_:2},1024)])]))),128))])]),_:1}),o("div",ve,[o("div",be,[t(C,{page:n.page,"onUpdate:page":e[7]||(e[7]=r=>n.page=r),"page-count":n.pageNum,"on-update:page":r=>{u.getByPage(r),n.page=r}},null,8,["page","page-count","on-update:page"])])])],64)}const ke=S(he,[["render",xe]]);let z="http://"+window.location.host;const Pe={name:"course_manager",data(){return{courses:[],newCourseDialog:!1,courseName:"",score:1,time:1}},mounted(){this.getAllCourse()},methods:{deleteCourse(s){let e=this;b.post(z+"/api/course/delete-course",I.stringify({id:s})).then(i=>{i.data.status===0&&(window.$message.success("删除完毕"),e.getAllCourse())})},addCourse(){let s=this;b.post(z+"/api/course/add-course",I.stringify({name:this.courseName,score:this.score,time:this.time})).then(e=>{e.data.status===0&&(window.$message.success("添加完毕"),s.newCourseDialog=!1,s.getAllCourse())})},getAllCourse(){let s=this;b.get(z+"/api/course/all").then(e=>{s.courses=e.data.data})}}},Ce={style:{display:"inline-block"}},Ie=o("p",null,"学分",-1),Se={style:{display:"inline-block"}},De=o("p",null,"学时",-1),Ne=o("br",null,null,-1),Ue=o("thead",null,[o("tr",null,[o("th",null,"课程ID"),o("th",null,"课程名称"),o("th",null,"学分"),o("th",null,"学时"),o("th",null,"操作")])],-1),$e={key:"course"};function Oe(s,e,i,p,n,u){const m=a("n-input"),h=a("n-input-number"),g=a("n-space"),_=a("n-button"),f=a("n-modal"),x=a("n-table");return w(),v(P,null,[t(f,{style:{"text-align":"center"},show:n.newCourseDialog,"onUpdate:show":e[3]||(e[3]=d=>n.newCourseDialog=d),title:"新建课程",preset:"dialog"},{default:l(()=>[t(m,{style:{"margin-top":"10px","margin-bottom":"10px",width:"214px"},value:n.courseName,"onUpdate:value":e[0]||(e[0]=d=>n.courseName=d),placeholder:"课程名称"},null,8,["value"]),t(g,{justify:"center"},{default:l(()=>[o("div",Ce,[Ie,t(h,{min:1,"button-placement":"both",style:{display:"inline-block",width:"100px"},value:n.score,"onUpdate:value":e[1]||(e[1]=d=>n.score=d)},null,8,["value"])]),o("div",Se,[De,t(h,{min:1,"button-placement":"both",style:{display:"inline-block",width:"100px"},value:n.time,"onUpdate:value":e[2]||(e[2]=d=>n.time=d)},null,8,["value"])])]),_:1}),Ne,t(_,{style:{"margin-top":"10px"},onClick:u.addCourse},{default:l(()=>[c("确定")]),_:1},8,["onClick"])]),_:1},8,["show"]),t(g,{style:{"margin-bottom":"10px"}},{default:l(()=>[t(_,{strong:"",secondary:"",round:"",type:"info",onClick:e[4]||(e[4]=d=>n.newCourseDialog=!0)},{default:l(()=>[c("新建课程")]),_:1})]),_:1}),t(x,null,{default:l(()=>[Ue,o("tbody",null,[(w(!0),v(P,null,O(n.courses,d=>(w(),v("tr",$e,[o("td",null,y(d.id),1),o("td",null,y(d.name),1),o("td",null,y(d.courseScore),1),o("td",null,y(d.courseTime),1),o("td",null,[t(_,{strong:"",secondary:"",round:"",type:"error",onClick:C=>u.deleteCourse(d.id)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])])]))),128))])]),_:1})],64)}const Ae=S(Pe,[["render",Oe]]);let $="http://"+window.location.host;const Te={name:"course_manager",data(){return{teaches:[],newCourseDialog:!1,courseName:"",teachers:[],courses:[],students:[],teacherNo:"",courseId:"",selectedStudents:[],infoDialog:!1,studentsInfo:[]}},mounted(){this.getAllTeaches()},methods:{selectAll(s){this.selectedStudents=[],s&&this.students.forEach(e=>{this.selectedStudents.push(e.no)})},removeTeach(s,e){let i=this;this.studentsInfo=[],b.post($+"/api/teach/remove-teach",I.stringify({courseId:s,teacherNo:e})).then(p=>{window.$message.success("删除成功"),i.getAllTeaches()})},getTeachInfo(s,e){let i=this;this.studentsInfo=[],b.get($+"/api/teach/get-info?courseId="+s+"&teacherNo="+e).then(p=>{i.studentsInfo=p.data.data,i.infoDialog=!0})},deleteCourse(s){let e=this;b.post($+"/api/course/delete-course",I.stringify({id:s})).then(i=>{i.data.status===0&&(window.$message.success("删除成功"),e.getAllCourse())})},addTeach(){let s=this;b.post($+"/api/teach/add-teach",{teacherNo:this.teacherNo,courseId:this.courseId,students:this.selectedStudents}).then(e=>{e.data.status===0&&(window.$message.success("添加成功"),s.newCourseDialog=!1,s.getAllTeaches())})},getAllTeaches(){let s=this;b.get($+"/api/teach/all").then(e=>{s.teaches=e.data.data}),b.get($+"/api/teach/info").then(e=>{s.teachers=[],s.courses=[],e.data.data.teacher.forEach(i=>{s.teachers.push({label:i.name,value:i.no})}),console.log(s.teachers),e.data.data.course.forEach(i=>{s.courses.push({label:i.name,value:i.id})})}),b.get($+"/api/teach/students").then(e=>{s.students=e.data.data})}}},Be={style:{display:"inline-block","text-align":"left"}},Ee={key:"stu"},Le=o("div",{style:{"margin-top":"5px"}},"教师:",-1),Re=o("div",{style:{"margin-top":"5px"}},"课程:",-1),Me={key:"stu"},ze=o("thead",null,[o("tr",null,[o("th",null,"教学ID"),o("th",null,"课程ID"),o("th",null,"课程名称"),o("th",null,"教师工号"),o("th",null,"教师姓名"),o("th",null,"学生名单"),o("th",null,"操作")])],-1),Ve={key:"teach"};function je(s,e,i,p,n,u){const m=a("n-modal"),h=a("n-select"),g=a("n-space"),_=a("n-button"),f=a("n-checkbox"),x=a("n-checkbox-group"),d=a("n-card"),C=a("n-table");return w(),v(P,null,[t(m,{title:"授课学生",style:{"text-align":"center"},show:n.infoDialog,"onUpdate:show":e[0]||(e[0]=r=>n.infoDialog=r),preset:"dialog"},{default:l(()=>[o("div",Be,[(w(!0),v(P,null,O(n.studentsInfo,r=>(w(),v("p",Ee,y(r.no+" "+r.name),1))),128))])]),_:1},8,["show"]),t(m,{style:{"text-align":"center"},show:n.newCourseDialog,"onUpdate:show":e[6]||(e[6]=r=>n.newCourseDialog=r),title:"新建教学计划",preset:"dialog"},{default:l(()=>[t(g,{vertical:""},{default:l(()=>[t(g,{style:{"margin-top":"20px"}},{default:l(()=>[Le,t(h,{style:{width:"300px"},value:n.teacherNo,"onUpdate:value":e[1]||(e[1]=r=>n.teacherNo=r),options:n.teachers,placeholder:"请选择教师"},null,8,["value","options"])]),_:1}),t(g,null,{default:l(()=>[Re,t(h,{style:{width:"300px"},value:n.courseId,"onUpdate:value":e[2]||(e[2]=r=>n.courseId=r),options:n.courses,placeholder:"请选择课程"},null,8,["value","options"])]),_:1}),c(" 选择需要学习此门课程的学生 "),t(d,{style:{overflow:"auto",height:"600px"}},{default:l(()=>[t(g,{justify:"center",style:{"margin-bottom":"10px"}},{default:l(()=>[t(_,{onClick:e[3]||(e[3]=r=>u.selectAll(!0))},{default:l(()=>[c("全选")]),_:1}),t(_,{onClick:e[4]||(e[4]=r=>u.selectAll(!1))},{default:l(()=>[c("全不选")]),_:1})]),_:1}),t(x,{value:n.selectedStudents,"onUpdate:value":e[5]||(e[5]=r=>n.selectedStudents=r)},{default:l(()=>[t(g,{"item-style":"display: flex;"},{default:l(()=>[(w(!0),v(P,null,O(n.students,r=>(w(),v("div",Me,[t(f,{style:{width:"200px"},value:r.no,label:r.no+"  "+r.name},null,8,["value","label"])]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),t(_,{style:{"margin-top":"10px"},onClick:u.addTeach},{default:l(()=>[c("确定")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["show"]),t(g,{style:{"margin-bottom":"10px"}},{default:l(()=>[t(_,{strong:"",secondary:"",round:"",type:"info",onClick:e[7]||(e[7]=r=>n.newCourseDialog=!0)},{default:l(()=>[c("新建教学计划")]),_:1})]),_:1}),t(C,null,{default:l(()=>[ze,o("tbody",null,[(w(!0),v(P,null,O(n.teaches,r=>(w(),v("tr",Ve,[o("td",null,y(r.id),1),o("td",null,y(r.courseId),1),o("td",null,y(r.courseName),1),o("td",null,y(r.teacherNo),1),o("td",null,y(r.teacherName),1),o("td",null,[t(_,{strong:"",secondary:"",round:"",type:"primary",onClick:D=>u.getTeachInfo(r.courseId,r.teacherNo)},{default:l(()=>[c("查看")]),_:2},1032,["onClick"])]),o("td",null,[t(_,{strong:"",secondary:"",round:"",type:"error",onClick:D=>u.removeTeach(r.courseId,r.teacherNo)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])])]))),128))])]),_:1})],64)}const qe=S(Te,[["render",je]]);let Fe="http://"+window.location.host;const We={name:"teacher_page",data(){return{oldPass:"",newPass:"",confirmPass:"",changePassDialog:!1}},methods:{changePass(){if(this.newPass!==this.confirmPass){window.$message.error("两次密码输入不一致");return}this.newPass===""&&window.$message.error("新密码不能为空");let s=this;b.post(Fe+"/api/login/change-password",I.stringify({oldPass:this.oldPass,newPass:this.newPass},{withCredentials:!0})).then(e=>{e.data.status===0?(window.$message.success("密码已更改"),s.changePassDialog=!1):window.$message.error("密码修改失败, 原密码错误")})},logout(){sessionStorage.clear(),this.$router.replace("/index")}},setup(){console.log(sessionStorage.getItem("name"));let s=sessionStorage.getItem("name");return window.$message=R(),{menuOptions:[{label:()=>A(T,{to:"/teacher/record"},()=>"成绩录入"),key:"course"}],name:s}}},Ge=o("div",{class:"titlec"},[o("img",{class:"logoi",height:"36",src:M}),o("span",{class:"titlei"},"成绩管理-教师端")],-1),He={class:"userinfo"};function Ke(s,e,i,p,n,u){const m=a("n-input"),h=a("n-button"),g=a("n-space"),_=a("n-modal"),f=a("n-layout-header"),x=a("n-menu"),d=a("n-layout-sider"),C=a("router-view"),r=a("n-layout"),D=a("n-layout-footer");return w(),v(P,null,[t(_,{style:{"text-align":"center"},show:n.changePassDialog,"onUpdate:show":e[3]||(e[3]=k=>n.changePassDialog=k),preset:"dialog",title:"修改密码"},{default:l(()=>[t(g,{vertical:""},{default:l(()=>[t(m,{round:"",large:"",type:"password",value:n.oldPass,"onUpdate:value":e[0]||(e[0]=k=>n.oldPass=k),placeholder:"旧密码"},null,8,["value"]),t(m,{round:"",large:"",type:"password",value:n.newPass,"onUpdate:value":e[1]||(e[1]=k=>n.newPass=k),placeholder:"新密码"},null,8,["value"]),t(m,{round:"",large:"",type:"password",value:n.confirmPass,"onUpdate:value":e[2]||(e[2]=k=>n.confirmPass=k),placeholder:"确认新密码"},null,8,["value"]),t(h,{round:"",secondary:"",strong:"",type:"primary",onClick:u.changePass},{default:l(()=>[c("确认")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["show"]),t(r,{position:"absolute"},{default:l(()=>[t(f,{style:{height:"64px",top:"0px"},bordered:""},{default:l(()=>[Ge,o("div",He,[c(" 你好, "+y(p.name)+" ",1),t(h,{round:"",tertiary:"",type:"warning",style:{margin:"0px 5px 0px 5px"},onClick:e[4]||(e[4]=k=>n.changePassDialog=!0)},{default:l(()=>[c("修改密码")]),_:1}),t(h,{round:"",tertiary:"",type:"error",onClick:u.logout},{default:l(()=>[c("退出")]),_:1},8,["onClick"])])]),_:1}),t(r,{"has-sider":"",position:"absolute",style:{top:"64px",bottom:"64px"}},{default:l(()=>[t(d,{bordered:"","content-style":"padding: 4px;"},{default:l(()=>[t(x,{options:p.menuOptions},null,8,["options"])]),_:1}),t(r,{"content-style":"padding: 24px;"},{default:l(()=>[t(C)]),_:1})]),_:1}),t(D,{bordered:"",position:"absolute",style:{height:"64px",padding:"24px","text-align":"center"}},{default:l(()=>[c(" gradeManagement   成绩管理 ")]),_:1})]),_:1})],64)}const Xe=S(We,[["render",Ke]]);var L="http://"+window.location.host;const Ye={name:"record_score",data(){return{options:[],infos:[],showingInfos:[],order:!1,courseId:0,statistics:{number:0,passPercentage:0,greatPercentage:0,averageScore:0,highestScore:0},showStatistics:!1}},methods:{checkedChange(s){s?this.showingInfos.sort((e,i)=>i.score-e.score):this.showingInfos=this.infos.slice()},updateScore(s,e,i){b.post(L+"/api/teacher/update-score",I.stringify({score:s??-1,courseId:e,studentNo:i}),{withCredentials:!0}).then(p=>{p.data.status!==0&&window.$message.error("修改失败, 成绩未保存! 与服务器通信失败")})},getStudentScores(s){this.showStatistics=!0,this.courseId=s;let e=this;b.get(L+"/api/teacher/get-scores?courseId="+s,{withCredentials:!0}).then(i=>{i.data.status===0&&(e.infos=i.data.data,e.showingInfos=e.infos.slice(),console.log(e.showingInfos))}),b.get(L+"/api/teacher/get-statistic-info?courseId="+s).then(i=>{i.data.status===0?e.statistics=i.data.data:window.$message.error("获取统计信息失败")})}},mounted(){let s=this;b.get(L+"/api/teacher/get-my-teach",{withCredentials:!0}).then(e=>{e.data.status===0&&e.data.data.forEach(i=>{s.options.push({label:i.name,value:i.id})})})}},Ze=o("p",{style:{"margin-top":"5px"}},"课程: ",-1),Je=o("thead",null,[o("tr",null,[o("th",null,"学号"),o("th",null,"姓名"),o("th",null,"分数")])],-1);function Qe(s,e,i,p,n,u){const m=a("n-select"),h=a("n-space"),g=a("n-checkbox"),_=a("n-statistic"),f=a("n-input-number"),x=a("n-table");return w(),v(P,null,[t(h,{justify:"center",style:{width:"700px"},vertical:!1},{default:l(()=>[Ze,t(m,{style:{width:"400px"},placeholder:"请选择任教的课程",options:n.options,"onUpdate:value":e[0]||(e[0]=d=>{u.getStudentScores(d)})},null,8,["options"])]),_:1}),N(t(g,{style:{margin:"20px"},label:"按成绩排序","on-update:checked":d=>u.checkedChange(d)},null,8,["on-update:checked"]),[[U,n.showStatistics]]),N(t(h,{size:"large"},{default:l(()=>[t(_,{label:"参加人数",value:n.statistics.number},null,8,["value"]),N(t(_,{label:"平均分",value:n.statistics.averageScore},null,8,["value"]),[[U,n.statistics]]),N(t(_,{label:"最高分",value:n.statistics.highestScore},null,8,["value"]),[[U,n.statistics]]),N(t(_,{label:"及格率",value:n.statistics.passPercentage},{suffix:l(()=>[c(" % ")]),_:1},8,["value"]),[[U,n.statistics]]),N(t(_,{label:"优秀率",value:n.statistics.greatPercentage},{suffix:l(()=>[c(" % ")]),_:1},8,["value"]),[[U,n.statistics]])]),_:1},512),[[U,n.showStatistics]]),N(t(x,null,{default:l(()=>[Je,o("tbody",null,[(w(!0),v(P,null,O(n.showingInfos,d=>(w(),v("tr",null,[o("td",null,y(d.no),1),o("td",null,y(d.name),1),o("td",null,[t(f,{"update-value-on-input":"","onUpdate:value":[C=>u.updateScore(C,n.courseId,d.no),C=>d.score=C],placeholder:"",style:{width:"100px"},value:d.score},null,8,["onUpdate:value","value"])])]))),256))])]),_:1},512),[[U,n.showStatistics]])],64)}const et=S(Ye,[["render",Qe]]);let tt="http://"+window.location.host;const nt={name:"student_page",data(){return{oldPass:"",newPass:"",confirmPass:"",changePassDialog:!1}},methods:{changePass(){if(this.newPass!==this.confirmPass){window.$message.error("两次密码输入不一致");return}this.newPass===""&&window.$message.error("新密码不能为空");let s=this;b.post(tt+"/api/login/change-password",I.stringify({oldPass:this.oldPass,newPass:this.newPass},{withCredentials:!0})).then(e=>{e.data.status===0?(window.$message.success("密码已更改"),s.changePassDialog=!1):window.$message.error("密码修改失败, 原密码输入错误")})},logout(){sessionStorage.clear(),this.$router.replace("/index")}},setup(){console.log(sessionStorage.getItem("name"));let s=sessionStorage.getItem("name");return window.$message=R(),{menuOptions:[{label:()=>A(T,{to:"/student/view"},()=>"成绩查询"),key:"user"}],name:s}}},ot=o("div",{class:"titlec"},[o("img",{class:"logoi",height:"36",src:M}),o("span",{class:"titlei"},"成绩管理-学生端")],-1),st={class:"userinfo"};function lt(s,e,i,p,n,u){const m=a("n-input"),h=a("n-button"),g=a("n-space"),_=a("n-modal"),f=a("n-layout-header"),x=a("n-menu"),d=a("n-layout-sider"),C=a("router-view"),r=a("n-layout"),D=a("n-layout-footer");return w(),v(P,null,[t(_,{style:{"text-align":"center"},show:n.changePassDialog,"onUpdate:show":e[3]||(e[3]=k=>n.changePassDialog=k),preset:"dialog",title:"修改密码"},{default:l(()=>[t(g,{vertical:""},{default:l(()=>[t(m,{round:"",large:"",type:"password",value:n.oldPass,"onUpdate:value":e[0]||(e[0]=k=>n.oldPass=k),placeholder:"旧密码"},null,8,["value"]),t(m,{round:"",large:"",type:"password",value:n.newPass,"onUpdate:value":e[1]||(e[1]=k=>n.newPass=k),placeholder:"新密码"},null,8,["value"]),t(m,{round:"",large:"",type:"password",value:n.confirmPass,"onUpdate:value":e[2]||(e[2]=k=>n.confirmPass=k),placeholder:"确认新密码"},null,8,["value"]),t(h,{round:"",secondary:"",strong:"",type:"primary",onClick:u.changePass},{default:l(()=>[c("确认")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["show"]),t(r,{position:"absolute"},{default:l(()=>[t(f,{style:{height:"64px",top:"0px"},bordered:""},{default:l(()=>[ot,o("div",st,[c(" 你好, "+y(p.name)+" ",1),t(h,{round:"",tertiary:"",type:"warning",style:{margin:"0px 5px 0px 5px"},onClick:e[4]||(e[4]=k=>n.changePassDialog=!0)},{default:l(()=>[c("修改密码")]),_:1}),t(h,{round:"",tertiary:"",type:"error",onClick:u.logout},{default:l(()=>[c("退出")]),_:1},8,["onClick"])])]),_:1}),t(r,{"has-sider":"",position:"absolute",style:{top:"64px",bottom:"64px"}},{default:l(()=>[t(d,{bordered:"","content-style":"padding: 4px;"},{default:l(()=>[t(x,{options:p.menuOptions},null,8,["options"])]),_:1}),t(r,{"content-style":"padding: 24px;"},{default:l(()=>[t(C)]),_:1})]),_:1}),t(D,{bordered:"",position:"absolute",style:{height:"64px",padding:"24px","text-align":"center"}},{default:l(()=>[c(" gradeManagement   成绩管理 ")]),_:1})]),_:1})],64)}const at=S(nt,[["render",lt]]);let rt="http://"+window.location.host;const it={name:"student_view",data(){return{scores:[],totalCourseScore:0}},setup(){return{numberAnimationInstRef:W(0)}},mounted(){let s=this;b.get(rt+"/api/student/scores",{withCredentials:!0}).then(e=>{e.data.status===0&&(s.scores=e.data.data,s.scores.forEach(i=>{i.score>=60&&(s.totalCourseScore+=i.courseScore)}))})}},ut=o("thead",null,[o("tr",null,[o("th",null,"科目"),o("th",null,"成绩"),o("th",null,"任课教师"),o("th",null,"学分"),o("th",null,"学时"),o("th",null,"绩点")])],-1),ct={key:"i"};function dt(s,e,i,p,n,u){const m=a("n-number-animation"),h=a("n-statistic"),g=a("n-card"),_=a("n-table");return w(),v(P,null,[t(g,{style:{width:"150px","text-align":"center",margin:"10px"}},{default:l(()=>[t(h,{label:"总学分","tabular-nums":""},{suffix:l(()=>[c(" 分 ")]),default:l(()=>[t(m,{precision:1,ref:"numberAnimationInstRef",from:0,to:n.totalCourseScore},null,8,["to"])]),_:1})]),_:1}),t(_,{style:{margin:"10px"}},{default:l(()=>[ut,o("tbody",null,[(w(!0),v(P,null,O(n.scores,f=>(w(),v("tr",ct,[o("td",null,y(f.courseName),1),o("td",{style:G("color: "+(f.score>60?"black":"red"))},y(f.score),5),o("td",null,y(f.teacherName),1),o("td",null,y(f.score<60?"0":f.courseScore),1),o("td",null,y(f.courseTime),1),o("td",null,y(f.score<=60?0:(f.score-60)/10),1)]))),128))])]),_:1})],64)}const pt=S(it,[["render",dt]]);const V=H(Q),_t=[{path:"/",redirect:"/index",children:[{path:"/index",component:ue},{path:"/admin",component:me,redirect:"/admin/user",children:[{path:"user",component:ke},{path:"course",component:Ae},{path:"teach",component:qe}]},{path:"/teacher",component:Xe,redirect:"/teacher/record",children:[{path:"record",component:et}]},{path:"/student",component:at,redirect:"/student/view",children:[{path:"view",component:pt}]}]}],mt=K({history:X(),routes:_t});V.use(Y);V.use(mt);V.mount("#app");
